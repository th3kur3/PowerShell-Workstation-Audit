\# PowerShell-Workstation-Audit-Script

\# A PowerShell script which can be copied/pasted into a PowerShell console window and retrieve auditable workstation configuration settings. This script only runs a series a queries (it does not make any modifications) and then creates a folder with a text document on the user's desktop named after the computer name which can then be zipped and uploaded as supporting documentation.

\# This script needs to be run as a user with "at least" local administrator rights on each workstaiton being audited seperately. Simply copy the entire blob of text below and paste into a PowerShell window in administrative mode.

\# Search PowerShell, right click the Windows PowerShell app, and select "run as administrator".

New-Item -ItemType directory -Path "$($env:USERPROFILE)\Desktop\Workstation Audit" ; echo "SYSTEM INFORMATION:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" ; systeminfo | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "USERS ON WORKSTATION:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; dir C:\Users | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "INSTALLED UPDATES:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; wmic qfe list | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "INSTALLED PROGRAMS:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; wmic product get name,version | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "BITLOCKER ENCRYPTION STATUS:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; manage-bde -status | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "SHARES:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; net share | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "ANTIVIRUS INFORMATION:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; Get-MpComputerStatus | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "FIREWALL STATUS:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; netsh advfirewall show allprofiles | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "AUTOCOMPLETE SETTINGS:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; get-item 'HKCU:\Software\Policies\Microsoft\Internet Explorer\Main' | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; echo "LOCAL ADMINISTRATOR AND GUEST STATUS:" | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append ; Get-LocalUser | Out-File "$($env:USERPROFILE)\Desktop\Workstation Audit\\$env:computername.txt" -append
